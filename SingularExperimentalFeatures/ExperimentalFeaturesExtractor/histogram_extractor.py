import numpy as np
import pandas as pd


def sample_histograms(benign_histogram_dir, malicious_histogram_dir, benign_num, malicious_num):
    """

    :param malicious_histogram_dir:
    :param benign_histogram_dir:
    :param benign_num:
    :param malicious_num:
    :return:
    """
    benign_histograms = pd.read_csv(benign_histogram_dir, index_col=0).sample(n=benign_num)
    malicious_histograms = pd.read_csv(malicious_histogram_dir, index_col=0).sample(n=malicious_num)

    all_histograms_df = pd.concat([benign_histograms, malicious_histograms])

    return all_histograms_df


def scale_input_features(scaling_range_max, features_to_scale, labels):
    """

    :param scaling_range_max:
    :param features_to_scale:
    :param labels:
    :return:
    """
    np_result = []

    for i in range(len(features_to_scale)):
        x = np.asarray(features_to_scale[i])
        x_normalized = scaling_range_max * ((x - np.min(x)) / np.ptp(x))
        x_normalized_int = x_normalized.astype(np.uint8)

        x_normalized_int = np.append(x_normalized_int, labels[i])
        np_result.append(x_normalized_int)

    return np_result
