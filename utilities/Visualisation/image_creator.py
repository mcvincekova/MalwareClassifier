from utilities.Visualisation.graph_creator import create_pixel_image
from utilities.csv_helper_functions import read_n_csv_rows

MALICOUS_DATA_DIR_H = "/MalwareClassifier/Data/scaled_histograms/malicious_histograms_scaled.csv"
BENIGN_DATA_DIR_H = "/MalwareClassifier/Data/scaled_histograms/benign_histograms_scaled.csv"

MALICOUS_DATA_DIR_BE = "/MalwareClassifier/Data/scaled_entropy_histograms/malicious_entropy_histograms_scaled.csv"
BENIGN_DATA_DIR_BE = "/MalwareClassifier/Data/scaled_entropy_histograms/benign_entropy_histograms_scaled.csv"

MALICOUS_DATA_DIR_ST = "/MalwareClassifier/Data/scaled_strings_information/malicious_strings_information_scaled.csv"
BENIGN_DATA_DIR_ST = "/MalwareClassifier/Data/scaled_strings_information/benign_strings_information_scaled.csv"

MALICOUS_DATA_DIR_SE = "/MalwareClassifier/Data/scaled_sections_information/malicious_sections_information_scaled.csv"
BENIGN_DATA_DIR_SE = "/MalwareClassifier/Data/scaled_sections_information/benign_sections_information_scaled.csv"


def get_image_data(data_dir):
    samples_df = read_n_csv_rows(data_dir, 5)
    samples_df = samples_df.drop("label", axis=1)
    numpy_arr = samples_df.to_numpy()[1]

    return numpy_arr


def create_byte_histogram_image(image_data_dir, image_name):
    image_data = get_image_data(image_data_dir)
    create_pixel_image(image_data, (16, 16, 1), image_name)


def create_byte_entropy_histogram_image(image_data_dir, image_name):
    image_data = get_image_data(image_data_dir)
    create_pixel_image(image_data, (16, 16, 1), image_name)


def create_strings_histogram_image(image_data_dir, image_name):
    image_data = get_image_data(image_data_dir)
    create_pixel_image(image_data, (8, 12, 1), image_name)


def create_sections_image(image_data_dir, image_name):
    image_data = get_image_data(image_data_dir)
    create_pixel_image(image_data, (18, 22, 1), image_name)


# create_byte_histogram_image(BENIGN_DATA_DIR_H, "benignHistogram.png")
# create_byte_histogram_image(MALICOUS_DATA_DIR_H, "maliciousHistogram.png")

# create_byte_entropy_histogram_image(BENIGN_DATA_DIR_BE, "benignByteEntropyHistogram.png")
# create_byte_entropy_histogram_image(MALICOUS_DATA_DIR_BE, "maliciousByteEntropyHistogram.png")

# create_strings_histogram_image(BENIGN_DATA_DIR_ST, "benignStringsHistogram.png")
# create_strings_histogram_image(MALICOUS_DATA_DIR_ST, "maliciousStringsHistogram.png")

create_sections_image(BENIGN_DATA_DIR_SE, "benignSections1.png")
create_sections_image(MALICOUS_DATA_DIR_SE, "maliciousSections1.png")
