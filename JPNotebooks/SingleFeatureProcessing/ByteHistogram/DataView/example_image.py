from SingularExperimentalFeatures.ExperimentalFeaturesExtractor.samples import read_n_csv_rows
from SingularExperimentalFeatures.GraphUtilities.graph_creator import create_pixel_image

MALICOUS_DATA_DIR = "/MalwareClassifier/Data/scaled_histograms/malicious_histograms_scaled.csv"
BENIGN_DATA_DIR = "/MalwareClassifier/Data/scaled_histograms/benign_histograms_scaled.csv"


def get_image_data(data_dir):
    samples_df = read_n_csv_rows(data_dir, 5)
    samples_df = samples_df.drop("label", axis=1)
    numpy_arr = samples_df.to_numpy()[4]

    return numpy_arr


def create_benign_histogram_image():
    image_data = get_image_data(BENIGN_DATA_DIR)
    create_pixel_image(image_data, (8, 32, 1), "benign_byte_histogram.png")


def create_malicious_histogram_image():
    image_data = get_image_data(MALICOUS_DATA_DIR)
    create_pixel_image(image_data, (8, 32, 1), "malicious_byte_histogram.png")


create_benign_histogram_image()
create_malicious_histogram_image()
